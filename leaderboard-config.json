{
  "name": "MedAgentBench Leaderboard",
  "description": "Medical AI Agent Benchmark for Clinical Reasoning and Hallucination Detection",
  "version": "1.0.0",
  "green_agent_id": "019c17db-16c0-73f1-9cac-a1b50c656ff2",
  
  "subtasks": {
    "subtask1": {
      "name": "Clinical Decision Making",
      "description": "Medical record tasks: patient lookup, vitals, labs, medication ordering",
      "metrics": {
        "accuracy": {
          "type": "number",
          "display_name": "Accuracy",
          "description": "Proportion of tasks answered correctly",
          "sort_order": "desc",
          "format": "percent",
          "primary": true
        },
        "total_tasks": {
          "type": "integer",
          "display_name": "Tasks",
          "description": "Number of tasks evaluated"
        },
        "correct_tasks": {
          "type": "integer",
          "display_name": "Correct",
          "description": "Number of correct answers"
        },
        "timestamp": {
          "type": "string",
          "display_name": "Timestamp",
          "description": "ISO format timestamp"
        }
      }
    },
    "subtask2": {
      "name": "Confabulation Detection",
      "description": "Pokemon-Drugs hallucination detection benchmark",
      "metrics": {
        "accuracy": {
          "type": "number",
          "display_name": "Accuracy",
          "description": "Detection accuracy",
          "sort_order": "desc",
          "format": "percent",
          "primary": true
        },
        "hallucination_rate": {
          "type": "number",
          "display_name": "Hallucination Rate",
          "description": "Rate of hallucinations (lower is better)",
          "sort_order": "asc",
          "format": "percent"
        },
        "total_tasks": {
          "type": "integer",
          "display_name": "Cases",
          "description": "Number of cases evaluated"
        },
        "timestamp": {
          "type": "string",
          "display_name": "Timestamp",
          "description": "ISO format timestamp"
        }
      }
    }
  },

  "result_schema": {
    "required": ["subtask", "total_tasks", "accuracy"],
    "properties": {
      "subtask": {
        "type": "string",
        "enum": ["subtask1", "subtask2"]
      },
      "total_tasks": {
        "type": "integer"
      },
      "correct_tasks": {
        "type": "integer"
      },
      "accuracy": {
        "type": "number"
      },
      "hallucination_rate": {
        "type": "number",
        "description": "Subtask2 only"
      },
      "timestamp": {
        "type": "string",
        "description": "ISO format timestamp"
      }
    }
  },

  "queries": [
    {
      "name": "Clinical Decision Making (Subtask 1)",
      "query": "SELECT id, ROUND(accuracy, 3) AS \"Accuracy\", correct_tasks AS \"Correct\", total_tasks AS \"Total\", timestamp AS \"Date\" FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY id ORDER BY accuracy DESC, timestamp DESC) AS rn FROM (SELECT t.participants.medical_agent AS id, r.result.accuracy, r.result.correct_tasks, r.result.total_tasks, r.result.timestamp FROM results AS t CROSS JOIN UNNEST(t.results) AS r(result) WHERE r.result.subtask = 'subtask1')) WHERE rn = 1 ORDER BY accuracy DESC, timestamp DESC;"
    },
    {
      "name": "Confabulation Detection (Subtask 2)",
      "query": "SELECT id, ROUND(accuracy, 3) AS \"Accuracy\", ROUND(hallucination_rate, 3) AS \"Hallucination Rate\", total_tasks AS \"Cases\", timestamp AS \"Date\" FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY id ORDER BY accuracy DESC, hallucination_rate ASC, timestamp DESC) AS rn FROM (SELECT t.participants.medical_agent AS id, r.result.accuracy, r.result.hallucination_rate, r.result.total_tasks, r.result.timestamp FROM results AS t CROSS JOIN UNNEST(t.results) AS r(result) WHERE r.result.subtask = 'subtask2')) WHERE rn = 1 ORDER BY accuracy DESC, hallucination_rate ASC, timestamp DESC;"
    },
    {
      "name": "Overall Performance",
      "query": "SELECT id, ROUND(avg_accuracy, 3) AS \"Avg Accuracy\", submissions AS \"Submissions\", latest_date AS \"Latest Date\" FROM (SELECT t.participants.medical_agent AS id, AVG(r.result.accuracy) AS avg_accuracy, COUNT(*) AS submissions, MAX(r.result.timestamp) AS latest_date FROM results AS t CROSS JOIN UNNEST(t.results) AS r(result) GROUP BY t.participants.medical_agent) ORDER BY avg_accuracy DESC, latest_date DESC;"
    }
  ],

  "display_columns": {
    "subtask1": [
      {"field": "participant_id", "label": "Agent"},
      {"field": "accuracy", "label": "Accuracy", "format": "percent"},
      {"field": "correct_tasks", "label": "Correct"},
      {"field": "total_tasks", "label": "Total"},
      {"field": "timestamp", "label": "Date", "format": "date"}
    ],
    "subtask2": [
      {"field": "participant_id", "label": "Agent"},
      {"field": "accuracy", "label": "Accuracy", "format": "percent"},
      {"field": "hallucination_rate", "label": "Halluc. Rate", "format": "percent"},
      {"field": "total_tasks", "label": "Cases"},
      {"field": "timestamp", "label": "Date", "format": "date"}
    ]
  }
}
